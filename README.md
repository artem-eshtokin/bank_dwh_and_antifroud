# Дипломный проект
За проект получено максимальное количество баллов - 125/125.

## Описание задачи.
Разработать ETL процесс, получающий ежедневную выгрузку данных, загружающий ее в хранилище данных и ежедневно строящий отчет.

## Выгрузка данных.
Ежедневно некие информационные системы выгружают три следующих файла:
1. Список транзакций за текущий день. Формат – CSV.
2. Список терминалов полным срезом. Формат – XLSX.
3. Список паспортов, включенных в «черный список» - с накоплением с начала месяца. Формат – XLSX.
Сведения о картах, счетах и клиентах хранятся в СУБД PostgreSQL.
Реквизиты для подключения:

- Host: XXX.XXX.XXX.XXX
- Port: XXX
- Database: XXXX
- User: XXXXXXXX
- Password: XXXXXXXX

Вам предоставляется выгрузка за последние три дня, ее надо обработать.

## Построение отчета.
По результатам загрузки ежедневно необходимо строить витрину отчетности по мошенническим операциям. Витрина строится накоплением, каждый новый отчет укладывается в эту же таблицу с новым report_dt.

В витрине должны содержаться следующие поля:

- event_dt - Время наступления события. Если событие наступило по результату нескольких действий – указывается время действия, по которому установлен факт мошенничества.
- passport - Номер паспорта клиента, совершившего мошенническую операцию.
- fio - ФИО клиента, совершившего мошенническую операцию.
- phone - Номер телефона клиента, совершившего мошенническую операцию.
- event_type - Описание типа мошенничества (номер).
- report_dt - Дата, на которую построен отчет.

## Признаки мошеннических операций.
1. Совершение операции при просроченном или заблокированном паспорте.
2. Совершение операции при недействующем договоре.
3. Совершение операций в разных городах в течение одного часа.
4. Попытка подбора суммы. В течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней. Последняя операция (успешная) в такой цепочке считается мошеннической.

## Обработка файлов.
Выгружаемые файлы именуются согласно следующему шаблону:
- transactions_DDMMYYYY.txt
- passport_blacklist_DDMMYYYY.xlsx
- terminals_DDMMYYYY.xlsx
Предполагается что в один день приходит по одному такому файлу. После загрузки соответствующего файла он должен быть переименован в файл с расширением .backup чтобы при следующем запуске файл не искался и перемещен в каталог archive:
- transactions_DDMMYYYY.txt.backup
- passport_blacklist_DDMMYYYY.xlsx.backup
- terminals_DDMMYYYY.xlsx.backup

# Основные этапы

### 1. Извлечение данных.
Извлечение данных из транзакционной базы данных и файлов внешних систем.
### 2. Трансформация.
Сведение данных из различных источников, выявление целевых записей для загрузки в хранилище
### 3. Загрузка.
Загрузка данных в хранилище и формирование отчетности по выявлению случаев мошенничества на основе загруженных данных.

## Программные средства и технологии
1. Python.
Язык программирования общего назначения. Является одним из основных инструментов с сфере работы с данными.
2. PostgreSQL.
Свободная система управления базами данных (CУБД)
3. Linux.
Свободная операционная система.
4. Data Warehouse.
Предметно-ориентированная база данных, специально разработанная и предназначенная для подготовки отчётов и бизнес-анализа.
5. ETL.
Комплекс мер по загрузке данных из транзакционной базы данных в базу данных хранилища.
6. SCD2.
Механизм отслеживания изменений, позволяющих получать срез данных на любой момент времени (поддержка версионности и хранение истории).

## Основные функции
1. DDL код для быстрой развертки необходимых таблиц в БД.
2. Система логирования для быстрой оценки работоспособности системы.
3. Скрипт проверки файлов от источника данных из других систем.
4. Скрипт загрузки данных из файлов xlsx и csv.
5. Скрипт инкрементальной загрузки из БД источника.
6. Скрипт проверки пропущенных дней в источниках.
7. Скрипт переноса фактовых и исторических данных в детальный слой хранилища данных.
8. Скрипт переноса обработанных файлов в архив.
9. Скрипт заполнения таблицы с отчётом.
10. Cron файл для ежедневной загрузки данных.